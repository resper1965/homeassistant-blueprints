blueprint:
  name: Sincronizar Multiplos dispositivos by Esper
  description: Bind multiple entities together to act in unison (selected entities must all support the same state values)
  domain: automation
  input:
    switches:
      name: Dispositivos
      description: Lista de dispositivos para sincronizar
      selector:
        target:
          entity:
            domain: switch
mode: restart
max_exceeded: silent
trigger:
  - platform: state
    entity_id: !input 'switches'
variables:
  switches: !input 'switches'
action:
  - service: "homeassistant.turn_{{ trigger.to_state.state }}"
    target:
      entity_id: >
        {% set trigger_entity = trigger.entity_id %}
        {% set entities = expand(switches) | map(attribute='entity_id') | list %}
        {{ entities | reject('equalto', trigger_entity) | join(', ') }}
